{"mappings":"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","sources":["src/components/invoices/InvoiceAdd.jsx","src/logic/formValidation.js","src/components/reusables/CompanySelector.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport handleRequests from \"../../logic/handleRequests\";\r\nimport { invoiceVerify } from \"../../logic/formValidation\";\r\n\r\nimport CompanySelector from \"../reusables/CompanySelector\";\r\nimport ContactSelector from \"../reusables/ContactSelector\";\r\nimport InvoiceIllustration from \"../reusables/InvoiceIllustration.jsx\";\r\n// toaster\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n// end toaster\r\n\r\nfunction InvoiceAdd({ contacts, companies, categories, setIsLoaded, isAuth }) {\r\n  const [selectedCompany, setSelectedCompany] = useState(\"\");\r\n  const [selectedContact, setSelectedContact] = useState(\"\");\r\n  const [isFetching, setIsFetching] = useState(false);\r\n  useEffect(() => {\r\n    const message = sessionStorage.getItem(\"cogipToast\");\r\n    if (!message) return;\r\n    const messageArray = message.split(\",\");\r\n    toast[messageArray[0]](messageArray[1], {\r\n      position: toast.POSITION.BOTTOM_RIGHT,\r\n    });\r\n    sessionStorage.removeItem(\"cogipToast\");\r\n  }, [isFetching]);\r\n  const handleCompanyChange = (value) => {\r\n    setSelectedCompany(value);\r\n  };\r\n  const handleContactChange = (value) => {\r\n    setSelectedContact(value);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsFetching(true);\r\n    /* Instantiate object with form data */\r\n    const formData = {\r\n      reference: e.target.reference.value,\r\n      amount: parseInt(e.target.amount.value),\r\n      company: selectedCompany ? selectedCompany.id : null,\r\n      contact: selectedContact ? selectedContact.id : null,\r\n      received: e.target.date.value,\r\n      dueDate: e.target.dueDate.value,\r\n      paidStatus: e.target.paid.checked,\r\n      category: parseInt(e.target.category.value),\r\n      due: e.target.paid.checked ? 0 : parseInt(e.target.amount.value),\r\n      paid: e.target.paid.checked ? parseInt(e.target.amount.value) : 0,\r\n    };\r\n    console.log(formData);\r\n\r\n    // Data verification\r\n    let check = invoiceVerify(formData);\r\n    // Posting data if OK\r\n    if (check.ok) {\r\n      const { status, message, dataPackage } = await handleRequests(\r\n        \"POST\",\r\n        \"https://csharpproject.somee.com/api/Invoice\",\r\n        isAuth.jwt,\r\n        formData\r\n      );\r\n      setIsFetching(false);\r\n      setIsLoaded(false);\r\n      if (status === 200)\r\n        sessionStorage.setItem(\"cogipToast\", \"success,Success !\");\r\n      else sessionStorage.setItem(\"cogipToast\", `error,${message}`);\r\n    } else {\r\n      setIsFetching(false);\r\n      // Handling Errors\r\n      const issues = Object.keys(check);\r\n      setTimeout(() => {\r\n        for (let issue of issues) {\r\n          if (issue !== \"ok\") {\r\n            toast.error(check[issue], {\r\n              position: toast.POSITION.BOTTOM_RIGHT,\r\n            });\r\n          }\r\n        }\r\n      }, 250);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main>\r\n      <div className=\"invoiceAdd card\">\r\n        <h2>Fill up the form</h2>\r\n        <form className=\"invoiceForm\" onSubmit={handleSubmit}>\r\n          <div className=\"formContent\">\r\n            <fieldset>\r\n              <legend>Invoice details</legend>\r\n              <div>\r\n                <label htmlFor=\"reference\">Reference : </label>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"reference\"\r\n                  minLength=\"3\"\r\n                  maxLength=\"45\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"date\">Date of reception : </label>\r\n                <input type=\"date\" name=\"date\" required />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"company\">Company : </label>\r\n                <CompanySelector\r\n                  companies={companies}\r\n                  handleCompanyChange={handleCompanyChange}\r\n                  currentCompany={{ name: \"\" }}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"contact\">Contact : </label>\r\n                <ContactSelector\r\n                  contacts={contacts}\r\n                  companies={companies}\r\n                  selectedCompany={selectedCompany}\r\n                  handleContactChange={handleContactChange}\r\n                  currentContact={{ name: \"\" }}\r\n                  name={\"company\"}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"category\">Category : </label>\r\n                <select name=\"category\" id=\"category\">\r\n                  <option value=\"\">Select a category</option>\r\n                  {categories\r\n                    ? categories.map((category) => (\r\n                        <option key={category.id} value={category.id}>\r\n                          {category.category}\r\n                        </option>\r\n                      ))\r\n                    : null}\r\n                </select>\r\n              </div>\r\n            </fieldset>\r\n            <fieldset>\r\n              <legend>Payement</legend>\r\n              <div>\r\n                <label htmlFor=\"amount\">Amount : </label>\r\n                <input type=\"number\" name=\"amount\" required />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"dueDate\">Due date : </label>\r\n                <input type=\"date\" name=\"dueDate\" required />\r\n              </div>\r\n              <div>\r\n                <span>Paid status : </span>\r\n                <label htmlFor=\"paid\" className=\"switchToggle\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    name=\"paid\"\r\n                    id=\"paid\"\r\n                    className=\"switchCheck\"\r\n                  />\r\n                  <span className=\"slider\"></span>\r\n                </label>\r\n              </div>\r\n            </fieldset>\r\n          </div>\r\n          <button>Submit</button>\r\n        </form>\r\n        <div className=\"formIllu\">\r\n          <InvoiceIllustration />\r\n        </div>\r\n        <ToastContainer />\r\n      </div>\r\n      {isFetching ? (\r\n        <div className=\"fetching dark\">\r\n          <div className=\"lds-dual-ring\"></div>\r\n        </div>\r\n      ) : null}\r\n    </main>\r\n  );\r\n}\r\n\r\nexport default InvoiceAdd;\r\n","const invoiceVerify = (dataToVerify) => {\r\n  let response = {};\r\n  if (!dataToVerify.reference) response.reference = \"Please enter a reference\";\r\n  if (!dataToVerify.company) response.company = \"Please select a company\";\r\n  if (!dataToVerify.amount) response.amount = \"Please enter an amount\";\r\n  if (!dataToVerify.received) response.received = \"Please select a date\";\r\n  if (dataToVerify.paidStatus !== false && dataToVerify.paidStatus !== true)\r\n    response.paid = \"Please select a paid status\";\r\n  response.ok = Object.keys(response).length > 0 ? false : true;\r\n  return response;\r\n};\r\nconst contactVerify = (dataToVerify) => {\r\n  let response = {};\r\n  if (!dataToVerify.firstname) response.firstname = \"Please enter a firstname\";\r\n  if (!dataToVerify.lastname) response.lastname = \"Please enter a lastname\";\r\n  if (!dataToVerify.companies) response.companies = \"Please select a contact\";\r\n  if (!dataToVerify.email) response.email = \"Please enter an email\";\r\n  if (!dataToVerify.phonenumber)\r\n    response.phonenumber = \"Please enter a phone number\";\r\n  response.ok = Object.keys(response).length > 0 ? false : true;\r\n  return response;\r\n};\r\n\r\nconst companyVerify = (dataToVerify) => {\r\n  let response = {};\r\n  if (!dataToVerify.name) response.name = \"Please enter a name\";\r\n  if (!dataToVerify.vat) response.vat = \"Please enter a vat number\";\r\n  if (!dataToVerify.town) response.town = \"Please enter a town\";\r\n  if (!dataToVerify.street) response.street = \"Please enter a street\";\r\n  if (!dataToVerify.streetnumber)\r\n    response.streetnumber = \"Please enter a street number\";\r\n  if (!dataToVerify.country) response.country = \"Please enter a country\";\r\n  if (!dataToVerify.status) response.status = \"Please select a status\";\r\n  response.ok = Object.keys(response).length > 0 ? false : true;\r\n  return response;\r\n};\r\n\r\nexport { invoiceVerify, contactVerify, companyVerify };\r\n","function CompanySelector({\r\n  companies,\r\n  handleCompanyChange,\r\n  currentCompany,\r\n  name,\r\n}) {\r\n  return (\r\n    <select\r\n      onChange={(e) => {\r\n        let company = companies.find((el) => el.name == e.target.value)\r\n          ? companies.find((el) => el.name == e.target.value)\r\n          : \"\";\r\n        handleCompanyChange(company);\r\n      }}\r\n      defaultValue={currentCompany.name}\r\n      name={name}\r\n      required\r\n    >\r\n      <option value=\"\">Select a company</option>\r\n      {companies.map((company) => {\r\n        return (\r\n          <option value={company.name} key={company.id}>\r\n            {company.name}\r\n          </option>\r\n        );\r\n      })}\r\n    </select>\r\n  );\r\n}\r\n\r\nexport default CompanySelector;\r\n"],"names":["$d356230963735a75$export$2e2bcd8739ae039","contacts","companies","categories","setIsLoaded","isAuth","selectedCompany","setSelectedCompany","$eCRxs","useState","selectedContact","setSelectedContact","isFetching","setIsFetching","useEffect","message","sessionStorage","getItem","messageArray","split","$dv2Dk","toast","position","POSITION","BOTTOM_RIGHT","removeItem","$7C6UD","jsxs","className","onSubmit","async","e","preventDefault","formData","reference","target","value","amount","parseInt","company","id","contact","received","date","dueDate","paidStatus","paid","checked","category","due","console","log","check","$5H5kc","invoiceVerify","ok","status","dataPackage","$9aCo1","default","jwt","setItem","issues","Object","keys","setTimeout","issue","error","htmlFor","type","name","minLength","maxLength","required","$4yknE","handleCompanyChange","currentCompany","$eltSV","handleContactChange","currentContact","map","jsx","$lb0XH","ToastContainer","$42551951195d288c$export$7e6a64f84fea9213","dataToVerify","response","length","$42551951195d288c$export$9204046200024146","firstname","lastname","email","phonenumber","$42551951195d288c$export$927967c6383eee08","vat","town","street","streetnumber","country","$27c888b5041dae3c$export$2e2bcd8739ae039","onChange","find","el","defaultValue"],"version":3,"file":"InvoiceAdd.6781cf35.js.map"}