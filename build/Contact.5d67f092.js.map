{"mappings":"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","sources":["src/components/contacts/Contact.jsx","src/components/contacts/ContactControls.jsx","src/components/reusables/CompanySelector.jsx","src/logic/formValidation.js"],"sourcesContent":["import { useState, useRef, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport ContactControls from \"./ContactControls.jsx\";\nimport CompanySelector from \"../reusables/CompanySelector.jsx\";\nimport handleRequests from \"../../logic/handleRequests\";\nimport { contactVerify } from \"../../logic/formValidation\";\n\n// toaster\nimport { ToastContainer, toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n// end toaster\n\nfunction Contact({ contacts, companies, setIsLoaded, isAuth }) {\n  const loaded = contacts.length > 0 ? true : false;\n  const params = useParams();\n  const navigate = useNavigate();\n  const contact = contacts.find((el) => el.id == params.contactId);\n  const company = contact\n    ? companies.find((el) => el.id == contact.companies[0])\n    : null;\n  //console.log(company);\n  const [selectedCompany, setSelectedCompany] = useState(company);\n  const [isModifying, setIsModifying] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [isFetching, setIsFetching] = useState(false);\n\n  useEffect(() => {\n    if (!contact) navigate(\"/contacts\");\n  }, [contacts]);\n\n  const firstnameRef = useRef();\n  const lastnameRef = useRef();\n  const emailRef = useRef();\n  const phonenumberRef = useRef();\n  const handleCompanyChange = (company) => {\n    setSelectedCompany(company);\n  };\n  const handleModif = async () => {\n    const formData = {\n      firstname: firstnameRef.current.value,\n      lastname: lastnameRef.current.value,\n      contactcompany: selectedCompany.id.toString(),\n      email: emailRef.current.value,\n      phonenumber: phonenumberRef.current.value,\n    };\n    let check = contactVerify(formData);\n    setIsFetching(true);\n    if (check.ok) {\n      const { status, message, dataPackage } = await handleRequests(\n        \"PUT\",\n        `https://csharpproject.somee.com/api/contact/${params.contactId}`,\n        isAuth.jwt,\n        formData\n      );\n      setIsLoaded(false);\n      setIsFetching(false);\n      if (status === 200) {\n        setTimeout(() => {\n          toast.success(message, {\n            position: toast.POSITION.BOTTOM_RIGHT,\n          });\n        }, 250);\n      } else {\n        setTimeout(() => {\n          toast.error(message, {\n            position: toast.POSITION.BOTTOM_RIGHT,\n          });\n        }, 250);\n      }\n    } else {\n      setIsFetching(false);\n      const issues = Object.keys(check);\n      setTimeout(() => {\n        for (let issue of issues) {\n          if (issue !== \"ok\") {\n            toast.error(check[issue], {\n              position: toast.POSITION.BOTTOM_RIGHT,\n            });\n          }\n        }\n      }, 250);\n    }\n  };\n  const handleDelete = async () => {\n    setIsFetching(true);\n    const { status, message } = await handleRequests(\n      \"DELETE\",\n      `https://csharpproject.somee.com/api/Contact/${contact.id}`,\n      isAuth.jwt\n    );\n    setIsFetching(false);\n    if (status !== 200) {\n      toast.error(\"There was an error deleting this contact\", {\n        position: toast.POSITION.BOTTOM_RIGHT,\n      });\n    }\n    sessionStorage.setItem(\"cogipToast\", \"Success !\");\n    setIsDeleting(false);\n    setIsLoaded(false);\n  };\n  return (\n    <main>\n      {isFetching || !loaded || !contact ? (\n        <div className=\"fetching\">\n          <div className=\"lds-dual-ring\"></div>\n        </div>\n      ) : (\n        <div className=\"card\">\n          <h2>\n            {contact.firstname} {contact.lastname}\n          </h2>\n          <div className=\"contactGrid\">\n            <span>Firstname : </span>\n            {isModifying ? (\n              <input\n                type=\"text\"\n                name=\"contactFirstname\"\n                defaultValue={contact.firstname}\n                ref={firstnameRef}\n              />\n            ) : (\n              <span id=\"contactFirstname\">{contact.firstname}</span>\n            )}\n            <span>Lastname : </span>\n            {isModifying ? (\n              <input\n                type=\"text\"\n                name=\"contactLastname\"\n                defaultValue={contact.lastname}\n                ref={lastnameRef}\n              />\n            ) : (\n              <span id=\"contactLastname\">{contact.lastname}</span>\n            )}\n            <span>Companies : </span>\n            {isModifying ? (\n              <CompanySelector\n                currentCompany={company}\n                companies={companies}\n                name={\"contactCompany\"}\n                handleCompanyChange={handleCompanyChange}\n              />\n            ) : (\n              <span>\n                {companies.map((el) => {\n                  if (contact.companies.includes(el.id))\n                    return (\n                      <p\n                        id=\"contactCompany\"\n                        onClick={() => {\n                          navigate(`/company/${el.id}`);\n                        }}\n                        style={{ cursor: \"pointer\" }}\n                        key={el.id}\n                      >\n                        {el.name}\n                      </p>\n                    );\n                })}\n              </span>\n            )}\n            <span>Email : </span>\n            {isModifying ? (\n              <input\n                type=\"text\"\n                name=\"contactEmail\"\n                defaultValue={contact.email}\n                ref={emailRef}\n              />\n            ) : (\n              <span id=\"contactEmail\">{contact.email}</span>\n            )}\n            <span>Phone number : </span>\n            {isModifying ? (\n              <input\n                type=\"text\"\n                name=\"contactPhonenumber\"\n                defaultValue={contact.phonenumber}\n                ref={phonenumberRef}\n              />\n            ) : (\n              <span id=\"contactPhonenumber\">{contact.phonenumber}</span>\n            )}\n          </div>\n          {isAuth.role == \"Admin\" ? (\n            <ContactControls\n              isModifying={isModifying}\n              setIsModifying={setIsModifying}\n              isDeleting={isDeleting}\n              setIsDeleting={setIsDeleting}\n              handleModif={handleModif}\n              handleDelete={handleDelete}\n            />\n          ) : (\n            \"\"\n          )}\n        </div>\n      )}\n      <ToastContainer />\n    </main>\n  );\n}\n\nexport default Contact;\n","function ContactControls({\n  isModifying,\n  isDeleting,\n  setIsModifying,\n  setIsDeleting,\n  handleModif,\n  handleDelete,\n}) {\n  if (isModifying) {\n    return (\n      <div className={\"contactControls\"}>\n        <button type=\"button\" onClick={handleModif}>\n          Submit\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => {\n            setIsModifying(false);\n          }}\n        >\n          Cancel\n        </button>\n      </div>\n    );\n  }\n  if (isDeleting) {\n    return (\n      <div className={\"contactControls\"}>\n        <button type=\"button\" onClick={handleDelete}>\n          Confirm\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => {\n            setIsDeleting(false);\n          }}\n        >\n          Cancel\n        </button>\n      </div>\n    );\n  }\n  return (\n    <div className={\"contactControls\"}>\n      <button\n        type=\"button\"\n        onClick={() => {\n          setIsModifying(true);\n        }}\n      >\n        Modify\n      </button>\n      <button\n        type=\"button\"\n        onClick={() => {\n          setIsDeleting(true);\n        }}\n      >\n        Delete\n      </button>\n    </div>\n  );\n}\n\nexport default ContactControls;\n","function CompanySelector({\n  companies,\n  handleCompanyChange,\n  currentCompany,\n  name,\n}) {\n  return (\n    <select\n      onChange={(e) => {\n        let company = companies.find((el) => el.name == e.target.value)\n          ? companies.find((el) => el.name == e.target.value)\n          : \"\";\n        handleCompanyChange(company);\n      }}\n      defaultValue={currentCompany.name}\n      name={name}\n      required\n    >\n      <option value=\"\">Select a company</option>\n      {companies.map((company) => {\n        return (\n          <option value={company.name} key={company.id}>\n            {company.name}\n          </option>\n        );\n      })}\n    </select>\n  );\n}\n\nexport default CompanySelector;\n","const invoiceVerify = (dataToVerify) => {\n  let response = {};\n  if (!dataToVerify.reference) response.reference = \"Please enter a reference\";\n  if (!dataToVerify.company) response.company = \"Please select a company\";\n  if (!dataToVerify.amount) response.amount = \"Please enter an amount\";\n  if (!dataToVerify.contact) response.contact = \"Please select a contact\";\n  if (!dataToVerify.received) response.received = \"Please select a date\";\n  if (dataToVerify.paid !== false && dataToVerify.paid !== true)\n    response.paid = \"Please select a paid status\";\n  response.ok = Object.keys(response).length > 0 ? false : true;\n  return response;\n};\nconst contactVerify = (dataToVerify) => {\n  let response = {};\n  if (!dataToVerify.firstname) response.firstname = \"Please enter a firstname\";\n  if (!dataToVerify.lastname) response.lastname = \"Please enter a lastname\";\n  if (!dataToVerify.contactcompany)\n    response.contactcompany = \"Please select a contact\";\n  if (!dataToVerify.email) response.email = \"Please enter an email\";\n  if (!dataToVerify.phonenumber)\n    response.phonenumber = \"Please enter a phone number\";\n  response.ok = Object.keys(response).length > 0 ? false : true;\n  return response;\n};\n\nconst companyVerify = (dataToVerify) => {\n  let response = {};\n  if (!dataToVerify.name) response.name = \"Please enter a name\";\n  if (!dataToVerify.vat) response.vat = \"Please enter a vat number\";\n  if (!dataToVerify.status) response.status = \"Please select a status\";\n  response.ok = Object.keys(response).length > 0 ? false : true;\n  return response;\n};\n\nexport { invoiceVerify, contactVerify, companyVerify };\n"],"names":["$b8b37f0a6f9246e4$export$2e2bcd8739ae039","contacts","companies","setIsLoaded","isAuth","loaded","length","params","$kYfAi","useParams","navigate","useNavigate","contact","find","el","id","contactId","company1","selectedCompany","setSelectedCompany","$eCRxs","useState","isModifying","setIsModifying","isDeleting","setIsDeleting","isFetching","setIsFetching","useEffect","firstnameRef","useRef","lastnameRef","emailRef","phonenumberRef","$7C6UD","jsxs","className","firstname","lastname","jsx","type","name","defaultValue","ref","$4yknE","default","currentCompany","handleCompanyChange","company","map","includes","onClick","style","cursor","email","phonenumber","role","$9jFXu","handleModif","async","formData","current","value","contactcompany","toString","check","$5H5kc","contactVerify","ok","status","message","dataPackage","$9aCo1","jwt","setTimeout","$dv2Dk","toast","success","position","POSITION","BOTTOM_RIGHT","error","issues","Object","keys","issue","handleDelete","sessionStorage","setItem","ToastContainer","$5ed51abd9418945a$export$2e2bcd8739ae039","$27c888b5041dae3c$export$2e2bcd8739ae039","onChange","e","target","required","$42551951195d288c$export$7e6a64f84fea9213","dataToVerify","response","reference","amount","received","paid","$42551951195d288c$export$9204046200024146","$42551951195d288c$export$927967c6383eee08","vat"],"version":3,"file":"Contact.5d67f092.js.map"}